###################### 说明  ####################
#  带{{}}， 特殊符号和数字的变量需要加双引号
#  集群设置和系统设置后需要执行cmd/configure.sh， 其他配置修改即生效
#  为了保证生成的定时任务时间格式上统一， 请添加英文双引号
#  时间设置如下：
#  {{ curr_date }}      当前程序获取时间， 可在TradingDate.yml中配置，格式%Y%d%m
#  {{ pre_trd_date }}   当前程序获取时间的上一个交易日， 格式%Y%d%m
#  {{ next_trd_date }}   当前程序获取时间的下一个交易日， 格式%Y%d%m
#################################################


###################### 系统配置 #################
broker: swhy
taget: dev
system: mds
version: 0.17.6.5
mds_tarpkgs_name: mds-0.17.6.5_FullTS-release-20221012.tar.gz
mds_pkg_name: mds
ssh_user: mdsuser
ssh_port: 22                                          # 集群管理端口（默认为22）
se: node01                                              # 节点设置（node01 or node02）
job_run_user: ansible                                 # art执行用户
trd_check: yes                                        # 校验当前是否为交易日
skip_md5_check:                                       # 上海产品文件跳过md5校验（都不跳过请填[]）
#  - "sse"
  - "sse_etf"
###################### 系统配置 #################


##################### 集群配置 ##############
set_num: "01"                                          # 集群号配置
master_host: "192.168.11.190"                          # 主机设置
follow_host: "192.168.11.190"                          # 备机设置
arbiter_host: "192.168.11.190"                         # 仲裁机设置

master_enable: yes
follow_enable: yes
arbiter_enable: yes

master_available_cpu: "''"                             # 主机可用cpu核心数
follow_available_cpu: "''"                             # 备机可用cpu核心数
arbiter_available_cpu: "''"                            # 仲裁机可用cpu核心数
#####################

##################### 灾备配置 ##############
is_enable_mds_zb: "no"                                 # 是否启用mds灾备环境
mds_zb_host: "xx.xx.xx.xx"                             # mds灾备机器的ip
mds_zb_port: 22                                        # mds灾备机器的连接端口
mds_zb_user: "mdsuser"                                 # mds灾备机器的远程用户名
mds_zb_path: "/home/mdsuser/host_01/mds"               # mds灾备机器环境部署的路径

is_enable_mon_zb: "no"                                 # 是否启用mon灾备环境
mon_zb_host: "xx.xx.xx.xx"                             # mon灾备机器的ip
mon_zb_port: 22                                        # mon灾备机器的连接端口
mon_zb_user: "monuser"                                 # mon灾备机器的远程用户名
mon_zb_path: "/home/monuser/mon"                       # mon灾备机器环境部署的路径
###########################################

##################### 定时任务 配置##################
calendar_cron_register: yes
mon_cron_register: yes
sse_cron_register: yes
szse_cron_register:  yes
conf_cron_register: no
backup_cron_register: yes
##################### 定时任务 配置##################

################## calendar 相关 ##############
# 获取交易日历时间
calendar_start_hour: "06"
calendar_start_minute: "30"
################## calendar 相关 ##############

##################### 远程用户设置 ##################
mon_user: &user monuser
mon_host: &host 192.168.11.189
sse_user: *user
sse_host: *host
szse_user: *user
szse_host: *host
##################### 远程用户设置 ##################

################## conf获取 相关 ###############
gateway_path_root_conf: "/mon/conf"
conf_start_hour: "06"
conf_start_minute: "00"
conf_check_files:
  - name: "system.conf.base"
    dst: "conf/monitor/SET_00"
  - name: "system.conf.gws"
    dst: "conf/monitor/SET_00"
  - name: "ScheduleTasks.csv"
    dst: "conf/monitor/SET_00"
################# conf 相关 ###################

###################### mon设置 #################
mon_deploy_path: /home/monuser/mon                     # mon部署目录
gateway_path_root_mon: /mnt/quant360/import/mon/mds/01
mon_start_hour: "07"
mon_start_minute: "20"
mon_cp_files_list:
  - "ClientInfo.csv"
  - "TradingCalendar.csv"
  - "TradingDate.txt"
  - "IpFilter.csv"
  - "SecurityShares.csv"
  - "SecurityCodeMap.csv"
  - "UpgradeInfo.conf"
  - "BrokerParams.conf"

mon_cp_to_conf_files:
  - "UpgradeInfo.conf"
  - "BrokerParams.conf"

mon_check_files_list:
  - "ClientInfo.csv"
  - "TradingCalendar.csv"
  - "TradingDate.txt"
###################### mon设置 #################

###################### sse设置 #################
gateway_path_root_sse: /mnt/quant360/import/sse
sse_wait_time_for_complete: 30

sse_start_hour: "08"
sse_start_minute: "05"
sse_cp_files_list:
  - "cpxx0201{{ curr_date[4:] }}.txt"
  - "cpxx0202{{ curr_date[4:] }}.txt"
  - "dbp{{ curr_date[4:] }}.txt"
  - "reff03{{ curr_date[4:] }}.txt"
  - "reff0302{{ curr_date }}.xml"
  - "gzlx.{{ gzlx_mm.stdout[:-1].lstrip('0') }}{{ curr_date[-2:] }}"
  - "bondinfo{{ curr_date }}.txt"
  - "bondinfo{{ curr_date }}.zip"
  - "archive_bondinfo{{ curr_date }}.zip"

sse_check_files_list:
  - "cpxx0201{{ curr_date[4:] }}.txt"
  - "cpxx0202{{ curr_date[4:] }}.txt"
  - "dbp{{ curr_date[4:] }}.txt"
  - "gzlx.{{ gzlx_mm.stdout[:-1].lstrip('0') }}{{ curr_date[-2:] }}"
#  - "bondinfo{{ curr_date }}.txt"

###################### sse设置 #################

###################### szse设置 ################
gateway_path_root_szse: /mnt/quant360/import/szse
szse_start_hour: "07"
szse_start_minute: "30"
szse_cp_files_list:
  - "cashauctionparams_{{ curr_date }}.xml"
  - "securities_{{ curr_date }}.xml"
  - "derivativeauctionparams_{{ curr_date }}.xml"
  - "bondtradingparams_{{ curr_date }}.xml"
  - "bondrepoparams_{{ curr_date }}.xml"

szse_check_files_list:
  - "cashauctionparams_{{ curr_date }}.xml"
  - "securities_{{ curr_date }}.xml"
  - "derivativeauctionparams_{{ curr_date }}.xml"
###################### szse设置 ################


################### cron mds ####################
end_time: &end_time "0845"

backup_time_hh: "20"
backup_time_mm: "00"

cron_job_cycles: 5
################### cron mds ####################

################# 备份配置  #####################
is_clear_old_backup_files: "disable"                     # 是否启用清除指定的历史文件
clear_old_backup_datas: 30                               # 指定的历史文件保留天数
clear_old_backup_key_word_list:                          # 清除历史文件关键字列表
  - "txlog"

mds_clear_dir_before_backup:                             # 备份前清空的目录， 清除目录必须为mds节点的相对路径
  - "data/tick_store"                                    # 例：绝对路径为/home/mdsuser/host_01/mds/data/tick_store
  - "storage/tickdata"

art_mds_backup_list:
  - bkup_src: "{{ ansible_path_ansible_home }}/logs"
    bkup_name: "art_mds_logs"
    src_remove: "yes"
  - bkup_src: "{{ ansible_path_ansible_home }}/flag"
    bkup_name: "art_mds_flag"
    src_remove: "yes"

backup_list:
  - bkup_src: "{{ slave_path_mds_home_data }}"
    bkup_name: "data"
    src_remove: "yes"
  - bkup_src: "{{ slave_path_mds_home_logs }}"
    bkup_name: "logs"
    src_remove: "yes"
  - bkup_src: "{{ slave_path_mds_home_conf }}"
    bkup_name: "conf"
    src_remove: "no"

backup_multi_list:
  - bkup_src: "{{ slave_path_mds_home_txlog }}"
    bkup_name: "txlog"
    process_num: 5
    src_remove: "yes"
################# 备份配置  #####################

################# mon日志配置 ###################
monlog_url: "http://192.168.11.190:8080/mon/log/alarm"
monlog_set_num: "01"
monlog_retry: 3
monlog_server_num: "01"
monlog_platform: "MDS"
monlog_module: "art"
################# mon日志配置 ###################

################# 控制 列表 #####################
# 该注册列表中为每个定时任务的关闭， 初始值 no，设置yes 为关闭该定时任务， 设置no 为不关闭，（true， false同样有效）
# 定时任务设置为关闭，脚本可以正常执行 ，不会再注册修改定时任务，已注册的计划任务正常生效

disable_mon_collector: no
disable_sse_collector: no
disable_szse_collector: no
disable_mds_nakedstart: no
disable_conf_collector: yes
disable_mds_reset: no
disable_mds_shutoff: yes
disable_mds_load: no
disable_mds_stop: no
disable_mds_backup: no
################# 注册 列表 #####################


################# 可选控制  #####################
mon_end_time: *end_time
sse_end_time: *end_time
szse_end_time: *end_time
load_end_time: *end_time
conf_end_time: *end_time

mon_run_once: no
sse_run_once: no
conf_run_once: no
szse_run_once: no
load_run_once: no


set_mds_status: no
################################################
